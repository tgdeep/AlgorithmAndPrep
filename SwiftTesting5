ðŸ“… SwiftUI Testing Series

Snapshot Testing âœ…

ViewModel Testing âœ…

Async & Concurrency Testing âœ…

Navigation & Coordinator Testing âœ…

SwiftUI CI Testing Strategy â¬…ï¸ Today (Finale)

ðŸš€ SwiftUI CI Testing Strategy (Day 5)

Testing locally is good.

Testing automatically on every PR is production-grade engineering.

This section covers:

Running SwiftUI tests in CI

Snapshot verification in CI

Parallel test execution

Flaky test prevention

GitHub Actions & Xcode Cloud

Performance considerations

ðŸ§  CI Testing Goals

Your CI should:

âœ… Run unit tests
âœ… Run async tests
âœ… Verify snapshot tests
âœ… Fail on visual regressions
âœ… Run in parallel
âœ… Stay deterministic

1ï¸âƒ£ Basic GitHub Actions Setup (iOS)

Create:

.github/workflows/ios-tests.yml

name: iOS Tests

on:
  pull_request:
  push:
    branches: [ main ]

jobs:
  build-and-test:
    runs-on: macos-latest

    steps:
      - uses: actions/checkout@v3

      - name: Select Xcode
        run: sudo xcode-select -switch /Applications/Xcode.app

      - name: Build & Test
        run: |
          xcodebuild test \
            -scheme YourAppScheme \
            -destination 'platform=iOS Simulator,name=iPhone 15' \
            -enableCodeCoverage YES

2ï¸âƒ£ Snapshot Testing in CI

Snapshot tests must:

Use consistent simulator

Use fixed device configuration

Disable animations

Always specify device:
assertSnapshot(
    matching: view,
    as: .image(layout: .device(config: .iPhone13))
)

Disable animations in tests:
UIView.setAnimationsEnabled(false)

3ï¸âƒ£ Prevent Snapshot Flakiness

Common CI snapshot failures:

Different simulator device

Different iOS version

Font rendering differences

Animation frames captured mid-transition

Best Practices

âœ… Fix device type
âœ… Disable animations
âœ… Avoid dynamic timestamps
âœ… Mock network data
âœ… Avoid locale differences

4ï¸âƒ£ Running Tests in Parallel

Modern CI should run tests in parallel:

- name: Build & Test
  run: |
    xcodebuild test \
      -parallel-testing-enabled YES \
      -maximum-parallel-testing-workers 4


Benefits:

Faster builds

Scales well

Matches production teams

5ï¸âƒ£ Code Coverage Reporting

Enable coverage:

-enableCodeCoverage YES


Then export:

xcrun xccov view --report --json coverage.xcresult


Coverage target:

ViewModels: 90%+

Coordinators: 90%+

Services: 80%+

Views: minimal (logic-free)

6ï¸âƒ£ CI Strategy for Snapshot Updates

Never allow this in CI:

isRecording = true


Policy:

Snapshots recorded locally

Reviewed in PR

CI verifies only

7ï¸âƒ£ Xcode Cloud Setup (Alternative)

If using Xcode Cloud:

Enable tests on PR

Enable snapshot verification

Run on fixed device

Enable parallel test execution

Production apps often:

Run tests on PR

Run nightly UI tests

Run weekly snapshot verification

8ï¸âƒ£ Handling Flaky Async Tests

Common causes:

Race conditions

Time-based assertions

Improper cancellation handling

Fixes:

Use Task.yield()

Avoid sleep-based tests

Mock services

Mark ViewModels @MainActor

9ï¸âƒ£ Performance Optimization in CI

Avoid:

âŒ Running full UI tests every PR
âŒ Snapshotting every screen
âŒ Real network calls
âŒ Running on multiple simulators unnecessarily

Recommended pipeline:

PR:

Unit tests

Snapshot tests (critical screens)

Nightly:

UI tests

Accessibility tests

ðŸ”Ÿ Production Testing Pipeline Example
Pull Request
 â”œâ”€ Unit Tests
 â”œâ”€ Async Tests
 â”œâ”€ Coordinator Tests
 â””â”€ Snapshot Verification

Merge to Main
 â”œâ”€ Full Test Suite
 â””â”€ Code Coverage Report

Nightly
 â”œâ”€ UI Tests
 â”œâ”€ Accessibility Tests
 â””â”€ Performance Benchmarks

ðŸ”¥ Real-World CI Anti-Patterns

âŒ Snapshotting entire NavigationStacks
âŒ Testing network layer live
âŒ Huge snapshot diffs with no review
âŒ No device consistency
âŒ Ignoring flaky tests

ðŸ§  Interview Power Answer

If asked:

â€œHow do you integrate SwiftUI testing into CI?â€

Say:

â€œWe run unit and async tests on every PR via GitHub Actions, verify snapshot tests against a fixed simulator, enforce code coverage, and run UI tests nightly to avoid slowing down the PR pipeline.â€

That answer signals production experience.

â­ Final Golden Rules (Testing Series Summary)

Test logic, not views

Snapshot only high-value UI

Navigation is state

Async must be tested

CI must be deterministic

Identity bugs > rendering bugs

ðŸŽ‰ SwiftUI Testing Series Complete

You now have:

Snapshot Testing

ViewModel Testing

Async Testing

Navigation Testing

CI Strategy

That is a full production testing knowledge stack.
